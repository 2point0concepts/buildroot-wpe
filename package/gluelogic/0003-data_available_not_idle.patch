From fa4c7b45a0a2760c00a6470c34783960aba1e9d6 Mon Sep 17 00:00:00 2001
From: Albert Dahan <a.dahan@metrological.com>
Date: Thu, 11 Aug 2016 15:57:15 +0200
Subject: [PATCH] [QueuePlayer] Make sure state is not idle for DataAvailable

---
 QueuePlayer/CInterface.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/QueuePlayer/CInterface.cpp b/QueuePlayer/CInterface.cpp
index 7e1b468..44465af 100644
--- a/QueuePlayer/CInterface.cpp
+++ b/QueuePlayer/CInterface.cpp
@@ -711,7 +711,7 @@ class QueuePlayerWrapper : public Solutions::QueuePlayer::INotifications {
         _adminLock.Lock();
 
         // The sink wrapper might have been destroyed.
-        if (base->wrapper != nullptr) {
+        if (base->wrapper != nullptr && _state != IDLE) {
 
             reinterpret_cast<SinkWrapper*>(base->wrapper)->SetDataState(available ? SinkWrapper::DATA_AVAILABLE : SinkWrapper::DATA_EOS_SIGNALLED);
 
